<%- include('./partials/header.ejs');  %>

<h1>node4-5 Hello page3 Page</h1>
<p>ユーザメンテナンス（非同期通信）</p>

<input id="textvalue" type="text"><br>

<input id="getbutton" type="submit" value="取得（GET）">
<input id="postbutton" type="submit" value="登録（POST）">
<input id="putbutton" type="submit" value="変更（PUT）">
<input id="deletebutton" type="submit" value="削除（DELETE）">

<div id="output"></div>
<hr>
<img src="img/image1.jpg"><br>
<img src="img/image2.png">

<!-- js -->
<script>

// データの読み取り
$('#getbutton').click(function(e){
   let values = {
      name: $('#textvalue').val()
   }
   // 送信するデータの準備
   $.ajax({
      type: "GET",
      data: values,
      dataType: "JSON",
      url: "/users"
   })
   // データの送信（非同期）
   .done(function(results){
      console.log(typeof results);
      console.log(results);
      $('#output').append('GET : ' + results.name + '<br>');
   }).fail(function(xhr, textStatus, errorThrown){
      console.log("ajax通信に失敗しました。");
   }).always(function(xhr){
   });
});

$('#postbutton').click(function(e){
   let values = {
      name: $('#textvalue').val()
   }
   // 送信するデータの準備
   $.ajax({
      type: "POST",
      data: values,
      dataType: "JSON",
      url: "/users"
   })
   // データの送信（非同期）
   .done(function(results){
      console.log(typeof results);
      console.log(results);
      $('#output').append('POST : ' + results.name + '<br>');
   }).fail(function(xhr, textStatus, errorThrown){
      console.log("ajax通信に失敗しました。");
   }).always(function(xhr){
   });
});

</script>

<%- include('./partials/footer.ejs');  %>
